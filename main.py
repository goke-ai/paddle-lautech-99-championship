# on countdown end

def on_countdown_end():
    if info.score() > info.high_score() and info.score() >= 5:
        game.set_game_over_effect(True, effects.confetti)
        game.game_over(True)
    else:
        game.set_game_over_effect(False, effects.dissolve)
        game.game_over(False)
info.on_countdown_end(on_countdown_end)

# functions
def changeSpeed():
    ballSprite.vx *= -1
    ballSprite.vy *= -1
    if ballSprite.vx < 0:
        ballSprite.vx = 0 - randint(50, 100)
        ballSprite.vy = 0 - randint(50, 100)
    else:
        ballSprite.vx = randint(50, 100)
        ballSprite.vy = randint(50, 100)
ballSprite: Sprite = None
# setup
scene.set_background_color(1)
scene.set_background_image(assets.image("""
    Logo
"""))
game.splash("You shall not pass!", "Paddle LAUTECH'99 Game")
game.show_long_text("Stop the ball, score 5 and WIN!", DialogLayout.BOTTOM)
info.set_score(0)
info.start_countdown(30)
# sprites
# player sprite
playerSprite = sprites.create(img("""
        . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . . 
            . . . . . a a a a a a . . . . .
    """),
    SpriteKind.player)
playerSprite.set_position(10, randint(20, 100))
controller.move_sprite(playerSprite, 0, 100)
playerSprite.set_stay_in_screen(True)
# ball sprite
ballSprite = sprites.create(img("""
        . . . . . . . . . . . . . . . . 
            . . . . . . 4 4 4 4 . . . . . . 
            . . . . 4 4 4 5 5 4 4 4 . . . . 
            . . . 3 3 3 3 4 4 4 4 4 4 . . . 
            . . 4 3 3 3 3 2 2 2 1 1 4 4 . . 
            . . 3 3 3 3 3 2 2 2 1 1 5 4 . . 
            . 4 3 3 3 3 2 2 2 2 2 5 5 4 4 . 
            . 4 3 3 3 2 2 2 4 4 4 4 5 4 4 . 
            . 4 4 3 3 2 2 4 4 4 4 4 4 4 4 . 
            . 4 2 3 3 2 2 4 4 4 4 4 4 4 4 . 
            . . 4 2 3 3 2 4 4 4 4 4 2 4 . . 
            . . 4 2 2 3 2 2 4 4 4 2 4 4 . . 
            . . . 4 2 2 2 2 2 2 2 2 4 . . . 
            . . . . 4 4 2 2 2 2 4 4 . . . . 
            . . . . . . 4 4 4 4 . . . . . . 
            . . . . . . . . . . . . . . . .
    """),
    SpriteKind.player)
ballSprite.set_position(randint(80, 160), randint(0, 120))
ballSprite.set_velocity(randint(50, 100), randint(50, 100))
ballSprite.set_bounce_on_wall(True)
# goalline sprite
goalLineSprite = sprites.create(img("""
        22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
            22222
    """),
    SpriteKind.player)
goalLineSprite.set_position(0, 0)
# loop and overlap

def on_forever():
    if playerSprite.overlaps_with(ballSprite):
        changeSpeed()
        info.change_score_by(1)
        music.play(music.melody_playable(music.power_up),
            music.PlaybackMode.UNTIL_DONE)
    if goalLineSprite.overlaps_with(ballSprite):
        changeSpeed()
        info.change_score_by(-1)
        music.play(music.melody_playable(music.buzzer),
            music.PlaybackMode.UNTIL_DONE)
forever(on_forever)
